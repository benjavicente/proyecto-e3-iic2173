# Production dockerfile for the chat service
FROM python:3.10-slim AS builder
WORKDIR /workspace

# Install poetry
RUN pip install "poetry>=1.0"
RUN poetry config virtualenvs.in-project true

# Install production dependencies
COPY pyproject.toml poetry.lock ./
RUN poetry install --no-interaction --no-dev
ENV PATH="/workspace/.venv/bin:$PATH"

# Slimer image
FROM python:3.10-slim AS app
WORKDIR /workspace
COPY --from=builder /workspace/.venv /workspace/.venv
COPY . .
